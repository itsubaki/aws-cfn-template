AWSTemplateFormatVersion: '2010-09-09'

Description:
 AWS S3 Resource

Parameters:
 ProjectName:
  Description: ""
  Type: String

Outputs:
 S3BucketStaging:
  Description: ""
  Value: !Ref S3BucketStaging
  Export:
   Name: !Sub "${ProjectName}-s3bucket-staging"

 S3Bucket:
  Description: ""
  Value: !Ref S3Bucket
  Export:
   Name: !Sub "${ProjectName}-s3bucket"

 S3Endpoint:
  Description: ""
  Value: !Ref S3Endpoint
  Export:
   Name: !Sub "${ProjectName}-s3endpoint"

Resources:
 S3BucketStaging:
  Type: AWS::S3::Bucket
  Properties:
   BucketName: !Sub "${ProjectName}-staging"
   Tags:
    - Key: Name
      Value: !Sub "${ProjectName}-s3bucket-staging"
    - Key: ProjectName
      Value: !Ref ProjectName

 S3Bucket:
  Type: AWS::S3::Bucket
  Properties:
   BucketName: !Ref ProjectName
   Tags:
    - Key: Name
      Value: !Sub "${ProjectName}-s3bucket"
    - Key: ProjectName
      Value: !Ref ProjectName

 S3Endpoint:
  Type: AWS::EC2::VPCEndpoint
  Properties:
   VpcId: { "Fn::ImportValue": !Sub "${ProjectName}-vpc" }
   ServiceName: !Sub "com.amazonaws.${AWS::Region}.s3"
   RouteTableIds:
    - { "Fn::ImportValue": !Sub "${ProjectName}-rt-public" }
    - { "Fn::ImportValue": !Sub "${ProjectName}-rt-private" }
